<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ü–ª–∞–Ω–µ—Ä 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1em;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .day-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .day-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .day-header {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .clear-day-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .day-date {
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .task-item:hover {
            background: #e9ecef;
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .checkbox {
            width: 24px;
            height: 24px;
            min-width: 24px;
            border: 2px solid #667eea;
            border-radius: 6px;
            margin-right: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        .checkbox:hover {
            background: #f0f4ff;
            transform: scale(1.1);
        }

        .checkbox.checked {
            background: #667eea;
            color: white;
        }

        .task-text {
            flex: 1;
            font-size: 1em;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .time-block {
            margin-bottom: 15px;
        }

        .time-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .add-task-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .add-task-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }

        .calendar-day {
            aspect-ratio: 1;
            background: #f8f9fa;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .calendar-day:hover {
            background: #e9ecef;
            transform: scale(1.05);
        }

        .calendar-day.header {
            background: #667eea;
            color: white;
            cursor: default;
        }

        .calendar-day.header:hover {
            transform: none;
        }

        .calendar-day.today {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        .calendar-day.has-tasks::after {
            content: '';
            position: absolute;
            bottom: 5px;
            width: 6px;
            height: 6px;
            background: #28a745;
            border-radius: 50%;
        }

        .task-list {
            margin-top: 20px;
        }

        .task-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
            transition: all 0.3s;
        }

        .task-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .task-card.completed {
            opacity: 0.6;
        }

        .priority-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .priority-high {
            background: #fee;
            color: #dc3545;
        }

        .priority-medium {
            background: #fff3cd;
            color: #ffc107;
        }

        .priority-low {
            background: #d4edda;
            color: #28a745;
        }

        .habit-grid {
            display: grid;
            grid-template-columns: 200px repeat(28, 1fr);
            gap: 5px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .habit-cell {
            padding: 10px;
            text-align: center;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .habit-header {
            background: #667eea;
            color: white;
            font-weight: 600;
            position: sticky;
            left: 0;
            z-index: 10;
        }

        .habit-name {
            background: #f8f9fa;
            font-weight: 600;
            text-align: left;
            position: sticky;
            left: 0;
            z-index: 5;
        }

        .habit-day {
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 35px;
        }

        .habit-day:hover {
            background: #e9ecef;
        }

        .habit-day.checked {
            background: #28a745;
            color: white;
        }

        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .export-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        }

        .goals-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .goal-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }

        .schedule-controls {
            margin-bottom: 10px;
            text-align: right;
        }

        .small-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            margin-left: 5px;
        }

        .small-btn:hover {
            background: #5a6268;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ü–ª–∞–Ω–µ—Ä 2026</h1>
            <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º –≤—Ä–µ–º–µ–Ω–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ ‚Ä¢ <span id="saveStatus" style="font-size: 0.9em;">üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</span></p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('weekly')">üìÖ –ù–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω–µ—Ä</button>
            <button class="tab" onclick="showTab('monthly')">üóìÔ∏è –ú–µ—Å—è—á–Ω—ã–π –æ–±–∑–æ—Ä</button>
            <button class="tab" onclick="showTab('tasks')">‚úÖ –¢—Ä–µ–∫–µ—Ä –∑–∞–¥–∞—á</button>
            <button class="tab" onclick="showTab('habits')">üí™ –¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫</button>
            <button class="tab" onclick="showTab('schedule')">‚è∞ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
            <button class="tab" onclick="showTab('notes')">üìù –ó–∞–º–µ—Ç–∫–∏</button>
        </div>

        <div class="content">
            <!-- Weekly Planner -->
            <div id="weekly" class="tab-content active">
                <h2 class="section-title">–ù–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω–µ—Ä</h2>
                <div class="week-grid" id="weekGrid"></div>
                <div class="goals-section">
                    <h3>üéØ –¶–µ–ª–∏ –Ω–∞ –Ω–µ–¥–µ–ª—é</h3>
                    <div id="weeklyGoals"></div>
                    <button class="add-task-btn" onclick="addWeeklyGoal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</button>
                </div>
            </div>

            <!-- Monthly Overview -->
            <div id="monthly" class="tab-content">
                <h2 class="section-title">–§–µ–≤—Ä–∞–ª—å 2026</h2>
                <div class="calendar-grid" id="calendarGrid"></div>
                <div class="goals-section">
                    <h3>üéØ –¶–µ–ª–∏ –º–µ—Å—è—Ü–∞</h3>
                    <div id="monthlyGoals"></div>
                    <button class="add-task-btn" onclick="addMonthlyGoal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</button>
                </div>
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="completedTasks">0</div>
                        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalTasks">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="habitStreak">0</div>
                        <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                </div>
            </div>

            <!-- Task Tracker -->
            <div id="tasks" class="tab-content">
                <h2 class="section-title">–¢—Ä–µ–∫–µ—Ä –∑–∞–¥–∞—á</h2>
                <div style="margin-bottom: 10px; text-align: right;">
                    <button class="small-btn" onclick="clearAllTasks()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏</button>
                </div>
                <div style="margin-bottom: 20px;">
                    <input type="text" id="newTaskInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É..." style="display: inline-block; width: calc(100% - 350px); margin-right: 10px;">
                    <select id="taskPriority" style="width: 120px; display: inline-block; margin-right: 10px;">
                        <option value="high">üî¥ –í—ã—Å–æ–∫–∏–π</option>
                        <option value="medium">üü° –°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="low">üü¢ –ù–∏–∑–∫–∏–π</option>
                    </select>
                    <select id="taskCategory" style="width: 120px; display: inline-block; margin-right: 10px;">
                        <option value="work">üíº –†–∞–±–æ—Ç–∞</option>
                        <option value="study">üìö –£—á—ë–±–∞</option>
                        <option value="personal">üë§ –õ–∏—á–Ω–æ–µ</option>
                        <option value="health">üí™ –ó–¥–æ—Ä–æ–≤—å–µ</option>
                        <option value="project">üöÄ –ü—Ä–æ–µ–∫—Ç—ã</option>
                    </select>
                    <button class="add-task-btn" onclick="addTask()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="task-list" id="taskList"></div>
            </div>

            <!-- Habit Tracker -->
            <div id="habits" class="tab-content">
                <h2 class="section-title">–¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫ (–§–µ–≤—Ä–∞–ª—å)</h2>
                <div style="margin-bottom: 10px; text-align: right;">
                    <button class="small-btn" onclick="clearAllHabits()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –æ—Ç–º–µ—Ç–∫–∏ –ø–æ –≤—Å–µ–º –ø—Ä–∏–≤—ã—á–∫–∞–º</button>
                </div>
                <div style="margin-bottom: 20px;">
                    <input type="text" id="newHabitInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –ø—Ä–∏–≤—ã—á–∫—É..." style="display: inline-block; width: calc(100% - 250px); margin-right: 10px;">
                    <button class="add-task-btn" onclick="addHabit()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="habit-grid" id="habitGrid"></div>
                <button class="export-btn" onclick="exportToExcel()">üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel</button>
                <button class="export-btn" style="background: #6c757d; margin-left: 10px;" onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
            </div>

            <!-- Schedule -->
            <div id="schedule" class="tab-content">
                <h2 class="section-title">–ü–æ—á–∞—Å–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h2>
                <div class="schedule-controls">
                    –û—á–∏—Å—Ç–∏—Ç—å –¥–µ–Ω—å:
                    <button class="small-btn" onclick="clearScheduleDay(0)">–ü–Ω</button>
                    <button class="small-btn" onclick="clearScheduleDay(1)">–í—Ç</button>
                    <button class="small-btn" onclick="clearScheduleDay(2)">–°—Ä</button>
                    <button class="small-btn" onclick="clearScheduleDay(3)">–ß—Ç</button>
                    <button class="small-btn" onclick="clearScheduleDay(4)">–ü—Ç</button>
                    <button class="small-btn" onclick="clearScheduleDay(5)">–°–±</button>
                    <button class="small-btn" onclick="clearScheduleDay(6)">–í—Å</button>
                </div>
                <div id="scheduleGrid"></div>
            </div>

            <!-- Notes -->
            <div id="notes" class="tab-content">
                <h2 class="section-title">–ó–∞–º–µ—Ç–∫–∏ –∏ –∏–¥–µ–∏</h2>
                <div style="margin-bottom: 20px;">
                    <input type="text" id="noteTitle" placeholder="–¢–µ–º–∞ –∑–∞–º–µ—Ç–∫–∏..." style="margin-bottom: 10px;">
                    <textarea id="noteContent" placeholder="–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏..."></textarea>
                    <input type="text" id="noteTags" placeholder="–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)..." style="margin-top: 10px;">
                    <button class="add-task-btn" onclick="addNote()">+ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–º–µ—Ç–∫—É</button>
                </div>
                <div id="notesList"></div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let plannerData = {
            weeklyTasks: {},
            weeklyGoals: [],
            monthlyGoals: [],
            tasks: [],
            habits: [
                {name: 'üèÉ –£—Ç—Ä–µ–Ω–Ω—è—è –∑–∞—Ä—è–¥–∫–∞', days: Array(28).fill(false)},
                {name: 'üìñ –ß—Ç–µ–Ω–∏–µ (30 –º–∏–Ω)', days: Array(28).fill(false)},
                {name: 'üíª –ò–∑—É—á–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è', days: Array(28).fill(false)},
                {name: 'üíß –í–æ–¥–∞ (2–ª)', days: Array(28).fill(false)},
                {name: 'üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è', days: Array(28).fill(false)}
            ],
            schedule: {},
            notes: []
        };

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('plannerData');
            if (saved) {
                plannerData = JSON.parse(saved);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('plannerData', JSON.stringify(plannerData));
            updateStats();
            showSaveStatus();
        }

        // Show save status notification
        function showSaveStatus() {
            const status = document.getElementById('saveStatus');
            status.textContent = '‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
            status.style.color = '#28a745';
            setTimeout(() => {
                status.textContent = 'üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏';
                status.style.color = 'white';
            }, 2000);
        }

        // Clear all data
        function clearAllData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')) {
                localStorage.removeItem('plannerData');
                location.reload();
            }
        }

        // Initialize app
        function init() {
            loadData();
            initWeekly();
            initMonthly();
            initTasks();
            initHabits();
            initSchedule();
            initNotes();
            updateStats();
        }

        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Weekly Planner
        function initWeekly() {
            const days = [
                {name: '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', date: '03.02.2026'},
                {name: '–í—Ç–æ—Ä–Ω–∏–∫', date: '04.02.2026'},
                {name: '–°—Ä–µ–¥–∞', date: '05.02.2026'},
                {name: '–ß–µ—Ç–≤–µ—Ä–≥', date: '06.02.2026'},
                {name: '–ü—è—Ç–Ω–∏—Ü–∞', date: '07.02.2026'},
                {name: '–°—É–±–±–æ—Ç–∞', date: '08.02.2026'},
                {name: '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', date: '09.02.2026'}
            ];

            const grid = document.getElementById('weekGrid');
            grid.innerHTML = '';

            days.forEach((day, index) => {
                if (!plannerData.weeklyTasks[index]) {
                    plannerData.weeklyTasks[index] = [];
                }

                const card = document.createElement('div');
                card.className = 'day-card';
                card.innerHTML = `
                    <div class="day-card-header">
                        <div class="day-header">${day.name}</div>
                        <button class="clear-day-btn" onclick="clearWeeklyDay(${index})">–û—á–∏—Å—Ç–∏—Ç—å –¥–µ–Ω—å</button>
                    </div>
                    <div class="day-date">${day.date}</div>
                    <div class="time-block">
                        <div class="time-label">üåÖ –£—Ç—Ä–æ (6-12)</div>
                        <input type="text" placeholder="–ó–∞–¥–∞—á–∏ –Ω–∞ —É—Ç—Ä–æ..." value="${plannerData.weeklyTasks[index][0] || ''}" onchange="updateWeeklyTask(${index}, 0, this.value)">
                    </div>
                    <div class="time-block">
                        <div class="time-label">‚òÄÔ∏è –î–µ–Ω—å (12-18)</div>
                        <input type="text" placeholder="–ó–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å..." value="${plannerData.weeklyTasks[index][1] || ''}" onchange="updateWeeklyTask(${index}, 1, this.value)">
                    </div>
                    <div class="time-block">
                        <div class="time-label">üåô –í–µ—á–µ—Ä (18-22)</div>
                        <input type="text" placeholder="–ó–∞–¥–∞—á–∏ –Ω–∞ –≤–µ—á–µ—Ä..." value="${plannerData.weeklyTasks[index][2] || ''}" onchange="updateWeeklyTask(${index}, 2, this.value)">
                    </div>
                `;
                grid.appendChild(card);
            });

            renderWeeklyGoals();
        }

        function updateWeeklyTask(dayIndex, timeIndex, value) {
            if (!plannerData.weeklyTasks[dayIndex]) {
                plannerData.weeklyTasks[dayIndex] = [];
            }
            plannerData.weeklyTasks[dayIndex][timeIndex] = value;
            saveData();
        }

        function clearWeeklyDay(dayIndex) {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏ –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å?')) {
                plannerData.weeklyTasks[dayIndex] = [];
                initWeekly();
                saveData();
            }
        }

        function renderWeeklyGoals() {
            const container = document.getElementById('weeklyGoals');
            container.innerHTML = '';
            plannerData.weeklyGoals.forEach((goal, index) => {
                const item = document.createElement('div');
                item.className = 'goal-item';
                item.innerHTML = `
                    <div class="checkbox ${goal.completed ? 'checked' : ''}" onclick="toggleWeeklyGoal(${index})">
                        ${goal.completed ? '‚úì' : ''}
                    </div>
                    <input type="text" class="task-text" value="${goal.text}" onchange="updateWeeklyGoalText(${index}, this.value)">
                    <button class="delete-btn" onclick="deleteWeeklyGoal(${index})">üóëÔ∏è</button>
                `;
                container.appendChild(item);
            });
        }

        function addWeeklyGoal() {
            plannerData.weeklyGoals.push({text: '', completed: false});
            renderWeeklyGoals();
            saveData();
        }

        function toggleWeeklyGoal(index) {
            plannerData.weeklyGoals[index].completed = !plannerData.weeklyGoals[index].completed;
            renderWeeklyGoals();
            saveData();
        }

        function updateWeeklyGoalText(index, text) {
            plannerData.weeklyGoals[index].text = text;
            saveData();
        }

        function deleteWeeklyGoal(index) {
            plannerData.weeklyGoals.splice(index, 1);
            renderWeeklyGoals();
            saveData();
        }

        // Monthly Overview
        function initMonthly() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';

            const headers = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            headers.forEach(h => {
                const cell = document.createElement('div');
                cell.className = 'calendar-day header';
                cell.textContent = h;
                grid.appendChild(cell);
            });

            // February 2026 starts on Sunday (day 0)
            for (let i = 0; i < 6; i++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-day';
                grid.appendChild(cell);
            }

            for (let day = 1; day <= 28; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-day';
                if (day === 4) cell.classList.add('today');
                cell.textContent = day;
                grid.appendChild(cell);
            }

            renderMonthlyGoals();
        }

        function renderMonthlyGoals() {
            const container = document.getElementById('monthlyGoals');
            container.innerHTML = '';
            plannerData.monthlyGoals.forEach((goal, index) => {
                const item = document.createElement('div');
                item.className = 'goal-item';
                item.innerHTML = `
                    <div class="checkbox ${goal.completed ? 'checked' : ''}" onclick="toggleMonthlyGoal(${index})">
                        ${goal.completed ? '‚úì' : ''}
                    </div>
                    <input type="text" class="task-text" value="${goal.text}" onchange="updateMonthlyGoalText(${index}, this.value)">
                    <button class="delete-btn" onclick="deleteMonthlyGoal(${index})">üóëÔ∏è</button>
                `;
                container.appendChild(item);
            });
        }

        function addMonthlyGoal() {
            plannerData.monthlyGoals.push({text: '', completed: false});
            renderMonthlyGoals();
            saveData();
        }

        function toggleMonthlyGoal(index) {
            plannerData.monthlyGoals[index].completed = !plannerData.monthlyGoals[index].completed;
            renderMonthlyGoals();
            saveData();
        }

        function updateMonthlyGoalText(index, text) {
            plannerData.monthlyGoals[index].text = text;
            saveData();
        }

        function deleteMonthlyGoal(index) {
            plannerData.monthlyGoals.splice(index, 1);
            renderMonthlyGoals();
            saveData();
        }

        // Task Tracker
        function initTasks() {
            renderTasks();
        }

        function renderTasks() {
            const container = document.getElementById('taskList');
            container.innerHTML = '';
            plannerData.tasks.forEach((task, index) => {
                const card = document.createElement('div');
                card.className = `task-card ${task.completed ? 'completed' : ''}`;
                card.innerHTML = `
                    <div class="checkbox ${task.completed ? 'checked' : ''}" onclick="toggleTask(${index})">
                        ${task.completed ? '‚úì' : ''}
                    </div>
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                            <span class="task-text" style="font-weight: 600;">${task.text}</span>
                            <span class="priority-badge priority-${task.priority}">
                                ${task.priority === 'high' ? 'üî¥ –í—ã—Å–æ–∫–∏–π' : task.priority === 'medium' ? 'üü° –°—Ä–µ–¥–Ω–∏–π' : 'üü¢ –ù–∏–∑–∫–∏–π'}
                            </span>
                        </div>
                        <div style="color: #6c757d; font-size: 0.9em;">
                            ${task.category === 'work' ? 'üíº –†–∞–±–æ—Ç–∞' : task.category === 'study' ? 'üìö –£—á—ë–±–∞' : task.category === 'personal' ? 'üë§ –õ–∏—á–Ω–æ–µ' : task.category === 'health' ? 'üí™ –ó–¥–æ—Ä–æ–≤—å–µ' : 'üöÄ –ü—Ä–æ–µ–∫—Ç—ã'}
                        </div>
                    </div>
                    <button class="delete-btn" onclick="deleteTask(${index})">üóëÔ∏è</button>
                `;
                container.appendChild(card);
            });
        }

        function addTask() {
            const input = document.getElementById('newTaskInput');
            const priority = document.getElementById('taskPriority').value;
            const category = document.getElementById('taskCategory').value;
            
            if (input.value.trim()) {
                plannerData.tasks.push({
                    text: input.value.trim(),
                    priority: priority,
                    category: category,
                    completed: false
                });
                input.value = '';
                renderTasks();
                saveData();
            }
        }

        function toggleTask(index) {
            plannerData.tasks[index].completed = !plannerData.tasks[index].completed;
            renderTasks();
            saveData();
        }

        function deleteTask(index) {
            plannerData.tasks.splice(index, 1);
            renderTasks();
            saveData();
        }

        function clearAllTasks() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏?')) {
                plannerData.tasks = [];
                renderTasks();
                saveData();
            }
        }

        // Habit Tracker
        function initHabits() {
            renderHabits();
        }

        function renderHabits() {
            const grid = document.getElementById('habitGrid');
            grid.innerHTML = '';

            // Header
            const headerCell = document.createElement('div');
            headerCell.className = 'habit-cell habit-header';
            headerCell.textContent = '–ü—Ä–∏–≤—ã—á–∫–∞';
            grid.appendChild(headerCell);

            for (let i = 1; i <= 28; i++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'habit-cell habit-header';
                dayCell.textContent = i;
                grid.appendChild(dayCell);
            }

            // Habits
            plannerData.habits.forEach((habit, habitIndex) => {
                const nameWrapper = document.createElement('div');
                nameWrapper.className = 'habit-cell habit-name';
                nameWrapper.style.display = 'flex';
                nameWrapper.style.justifyContent = 'space-between';
                nameWrapper.style.alignItems = 'center';

                const nameSpan = document.createElement('span');
                nameSpan.textContent = habit.name;

                const clearBtn = document.createElement('button');
                clearBtn.textContent = '–û—á–∏—Å—Ç–∏—Ç—å';
                clearBtn.className = 'small-btn';
                clearBtn.style.marginLeft = '10px';
                clearBtn.onclick = () => clearHabit(habitIndex);

                nameWrapper.appendChild(nameSpan);
                nameWrapper.appendChild(clearBtn);

                grid.appendChild(nameWrapper);

                for (let day = 0; day < 28; day++) {
                    const dayCell = document.createElement('div');
                    dayCell.className = `habit-cell habit-day ${habit.days[day] ? 'checked' : ''}`;
                    dayCell.textContent = habit.days[day] ? '‚úì' : '';
                    dayCell.onclick = () => toggleHabit(habitIndex, day);
                    grid.appendChild(dayCell);
                }
            });
        }

        function addHabit() {
            const input = document.getElementById('newHabitInput');
            if (input.value.trim()) {
                plannerData.habits.push({
                    name: input.value.trim(),
                    days: Array(28).fill(false)
                });
                input.value = '';
                renderHabits();
                saveData();
            }
        }

        function toggleHabit(habitIndex, day) {
            plannerData.habits[habitIndex].days[day] = !plannerData.habits[habitIndex].days[day];
            renderHabits();
            saveData();
        }

        function clearHabit(habitIndex) {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –æ—Ç–º–µ—Ç–∫–∏ –ø–æ —ç—Ç–æ–π –ø—Ä–∏–≤—ã—á–∫–µ?')) {
                plannerData.habits[habitIndex].days = Array(28).fill(false);
                renderHabits();
                saveData();
            }
        }

        function clearAllHabits() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –æ—Ç–º–µ—Ç–∫–∏ –ø–æ –≤—Å–µ–º –ø—Ä–∏–≤—ã—á–∫–∞–º?')) {
                plannerData.habits.forEach(h => h.days = Array(28).fill(false));
                renderHabits();
                saveData();
            }
        }

        // Schedule
        function initSchedule() {
            const container = document.getElementById('scheduleGrid');
            const hours = Array.from({length: 17}, (_, i) => i + 6);
            const days = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'];

            let html = '<table style="width: 100%; border-collapse: collapse;">';
            html += '<tr><th style="padding: 10px; background: #667eea; color: white;">–í—Ä–µ–º—è</th>';
            days.forEach(day => {
                html += `<th style="padding: 10px; background: #667eea; color: white;">${day}</th>`;
            });
            html += '</tr>';

            hours.forEach(hour => {
                html += `<tr><td style="padding: 10px; background: #f8f9fa; font-weight: 600;">${hour}:00</td>`;
                days.forEach((day, dayIndex) => {
                    const key = `${dayIndex}-${hour}`;
                    const value = plannerData.schedule[key] || '';
                    html += `<td style="padding: 5px;"><input type="text" value="${value}" onchange="updateSchedule('${key}', this.value)" style="width: 100%; padding: 8px;"></td>`;
                });
                html += '</tr>';
            });
            html += '</table>';
            container.innerHTML = html;
        }

        function updateSchedule(key, value) {
            plannerData.schedule[key] = value;
            saveData();
        }

        function clearScheduleDay(dayIndex) {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å?')) {
                const hours = Array.from({length: 17}, (_, i) => i + 6);
                hours.forEach(hour => {
                    const key = `${dayIndex}-${hour}`;
                    delete plannerData.schedule[key];
                });
                initSchedule();
                saveData();
            }
        }

        // Notes
        function initNotes() {
            renderNotes();
        }

        function renderNotes() {
            const container = document.getElementById('notesList');
            container.innerHTML = '';
            plannerData.notes.forEach((note, index) => {
                const card = document.createElement('div');
                card.className = 'task-card';
                card.innerHTML = `
                    <div style="flex: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h3 style="color: #667eea; margin: 0;">${note.title}</h3>
                            <span style="color: #6c757d; font-size: 0.9em;">${note.date}</span>
                        </div>
                        <p style="margin-bottom: 10px;">${note.content}</p>
                        ${note.tags ? `<div style="color: #667eea; font-size: 0.9em;">üè∑Ô∏è ${note.tags}</div>` : ''}
                    </div>
                    <button class="delete-btn" onclick="deleteNote(${index})">üóëÔ∏è</button>
                `;
                container.appendChild(card);
            });
        }

        function addNote() {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').value;
            const tags = document.getElementById('noteTags').value;

            if (title.trim() && content.trim()) {
                const now = new Date();
                plannerData.notes.push({
                    title: title,
                    content: content,
                    tags: tags,
                    date: now.toLocaleDateString('ru-RU')
                });
                document.getElementById('noteTitle').value = '';
                document.getElementById('noteContent').value = '';
                document.getElementById('noteTags').value = '';
                renderNotes();
                saveData();
            }
        }

        function deleteNote(index) {
            plannerData.notes.splice(index, 1);
            renderNotes();
            saveData();
        }

        // Statistics
        function updateStats() {
            const completed = plannerData.tasks.filter(t => t.completed).length;
            const total = plannerData.tasks.length;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('totalTasks').textContent = total;

            // Calculate habit streak
            let streak = 0;
            if (plannerData.habits.length > 0) {
                for (let day = 0; day < 28; day++) {
                    const allDone = plannerData.habits.every(h => h.days[day]);
                    if (allDone) streak++;
                    else if (streak > 0) break;
                }
            }
            document.getElementById('habitStreak').textContent = streak;
        }

        // Export to Excel (CSV format)
        function exportToExcel() {
            let csv = '–¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫ - –§–µ–≤—Ä–∞–ª—å 2026\n\n';
            csv += '–ü—Ä–∏–≤—ã—á–∫–∞,' + Array.from({length: 28}, (_, i) => i + 1).join(',') + ',–ò—Ç–æ–≥–æ\n';

            plannerData.habits.forEach(habit => {
                const total = habit.days.filter(d => d).length;
                csv += habit.name + ',' + habit.days.map(d => d ? '‚úì' : '').join(',') + ',' + total + '\n';
            });

            csv += '\n\n–ó–∞–¥–∞—á–∏\n';
            csv += '–ó–∞–¥–∞—á–∞,–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç,–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–°—Ç–∞—Ç—É—Å\n';
            plannerData.tasks.forEach(task => {
                csv += `"${task.text}",${task.priority},${task.category},${task.completed ? '–í—ã–ø–æ–ª–Ω–µ–Ω–æ' : '–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ'}\n`;
            });

            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'planner_export_' + new Date().toISOString().split('T')[0] + '.csv';
            link.click();
        }

        // Initialize on load
        window.onload = init;

        // Handle Enter key for inputs
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && e.target.id === 'newTaskInput') {
                addTask();
            } else if (e.key === 'Enter' && e.target.id === 'newHabitInput') {
                addHabit();
            }
        });
    </script>
</body>
</html>
